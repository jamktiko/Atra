<ion-content [fullscreen]="true">
  <ng-toast></ng-toast>
  <div class="items-center justify-center m-4">
    <form #customerForm="ngForm" (ngSubmit)="showModal()">
      <h1 class="text-2xl font-lato text-neutral-50 flex-1 py-2 text-center">
        Adding a new customer
      </h1>

      <p class=".pcustom flex-1 py-2 mx-3 text-center">
        Please fill in the following customer information.
      </p>

      <label
        for="first-name"
        class="block m-1 text-lg font-lato text-neutral-50"
        >First Name</label
      >
      <input
        type="text"
        id="firstname"
        [(ngModel)]="customer.first_name"
        #firstname="ngModel"
        name="firstname"
        minlength="2"
        pattern="^[A-Za-zÅÄÖåäöØøÆæÐð-]+$"
        class="text-slate-50 bg-slate-700 border border-gray-300 rounded-lg focus:ring-slate-500 focus:border-slate-500 block w-full p-2.5"
        placeholder="Enter firstname"
        required
      />

      @if (firstname.invalid && (firstname.touched )) {
      <ion-text class="text-red-600">
        <small>Please fill in a valid first name.</small>
      </ion-text>
      }

      <label for="last-name" class="block m-1 text-lg font-lato text-neutral-50"
        >Last Name</label
      >

      <input
        type="text"
        id="lastname"
        [(ngModel)]="customer.last_name"
        #lastname="ngModel"
        name="lastname"
        minlength="2"
        pattern="^[A-Za-zÅÄÖåäöØøÆæÐð-]+$"
        class="bg-slate-700 border border-gray-300 text-slate-50 rounded-lg focus:ring-slate-500 focus:border-slate-500 block w-full p-2.5"
        placeholder="Enter lastname"
        required
      />

      @if (lastname.invalid && lastname.touched) {
      <ion-text class="text-red-600">
        <small>Please fill in a valid last name.</small>
      </ion-text>
      }

      <label
        for="email"
        class="block mb-1 m-1 text-lg font-lato text-neutral-50"
        >Email address</label
      >
      <input
        type="text"
        id="email"
        [(ngModel)]="customer.email"
        #email="ngModel"
        name="email"
        placeholder="example@email.com"
        required
        pattern="^[a-zA-Z0-9._%+\-]+@[a-zA-Z0-9\-]+(\.[a-zA-Z]{2,})+$"
        class="text-slate-50 bg-slate-700 border border-gray-300 rounded-lg focus:ring-slate-500 focus:border-slate-500 block w-full p-2.5"
      />

      @if (email.invalid && email.touched) {
      <ion-text class="text-red-600">
        @if (email.errors?.['required']) {
        <small>Email is required.</small>
        } @if (email.errors?.['pattern']) {
        <small>Please enter a valid email address (with full domain).</small>
        }
      </ion-text>
      }

      <label
        for="phone"
        class="block mb-1 m-1 text-lg font-lato text-neutral-50"
        >Phone number (optional)</label
      >
      <input
        type="tel"
        id="tel"
        [(ngModel)]="customer.phone"
        #phonenumber="ngModel"
        name="phonenumber"
        pattern="^\+?[0-9]{1,3}([\- ]?[0-9]{1,4}){2,3}$"
        placeholder="358-123-4567"
        class="bg-slate-700 border border-gray-300 text-slate-50 rounded-lg focus:ring-slate-500 focus:border-slate-500 block w-full p-2.5"
      />

      @if (phonenumber.invalid && phonenumber.touched) {
      <ion-text class="text-red-600">
        <small>Phone number must be in valid format.</small>
      </ion-text>
      }

      <label
        for="notes"
        class="block mb-1 m-1 text-lg font-lato text-neutral-50"
        >Notes (optional)</label
      >
      <input
        type="text"
        id="notes"
        [(ngModel)]="customer.notes"
        #notes="ngModel"
        name="notes"
        placeholder="Notes about this customer"
        class="bg-slate-700 border border-gray-300 text-slate-50 rounded-lg focus:ring-slate-500 focus:border-slate-500 block w-full p-2.5"
      />
    </form>
  </div>

  @if (openModal) {
  <app-modalcustomer
    [newcustomer]="customer"
    (confirm)="handleConfirm($event)"
    (cancel)="handleCancel()"
    [openModal]="openModal"
  ></app-modalcustomer>
  }
  <div class="flex items-center justify-center space-x-4">
    <button
      class="text-neutral-50 bg-slate-400 inline-flex items-center font-medium rounded-lg text-lg px-4 py-2 text-center"
      (click)="back()"
    >
      Cancel
    </button>
    <button
      class="text-neutral-50 bg-slate-700 font-medium rounded-lg text-lg px-4 py-2 text-center disabled:bg-slate-800 disabled:text-slate-500"
      (click)="showModal()"
      [disabled]="!customerForm.valid"
    >
      Continue
    </button>
  </div>
</ion-content>
